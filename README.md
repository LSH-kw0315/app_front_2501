# React를 프론트엔드로 한 웹소켓 채팅 + AI 챗봇 앱

2025.01.08까지의 구현 도중 발생한 문제점

1. StrictMode일 때 최초 페이지 렌더링 시 2번 렌더링 되는 문제
* useEffect(() => {...}, [])에 등록된 콜백이 2번 호출되어 웹소켓 연결이 2번 발생
* 지금 당장은 StrictMode의 필요성을 느끼지 못해 삭제

2. 챗봇의 응답 내용을 모든 클라이언트가 공유하는 문제
* 하나의 클라이언트만 사용하는 것이라고 생각하고 설계해서 발생한 문제
* 클라이언트에서 uuid를 생성해 로컬 스토리지에 저장하고, 그 값으로 백엔드에서 AI챗봇을 위한 채팅방을 생성하도록 수정

3. "내가 보낸 메시지"를 구분하는 방법에 대한 고민
* 이것을 처리하지 못하면 내가 보낸 메시지를 웹소켓 통신에 의해 좌측에서 다시 한 번 받기 때문
  * messages라는 state에서 마지막 메시지에 접근 시도 => 비동기적인 state 업데이트 문제로 접근이 안되었음
  * 마지막 메시지를 useRef()를 이용해 messageEndRef에 담도록 하여 마지막 메시지에 접근하였음
  * 마지막 메시지의 작성자, 내용, 보낸 시간과 웹소켓으로 온 메시지의 작성자, 내용, 보낸 시간을 비교하도록 함 